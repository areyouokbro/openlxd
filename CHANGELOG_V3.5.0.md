# OpenLXD v3.5.0 æ›´æ–°æ—¥å¿—

å‘å¸ƒæ—¥æœŸï¼š2026-01-04

## ğŸ‰ é‡å¤§æ›´æ–°

v3.5.0 æ˜¯ä¸€ä¸ªé‡Œç¨‹ç¢‘å¼çš„ç‰ˆæœ¬ï¼Œæ·»åŠ äº†å¤šç§Ÿæˆ·ç®¡ç†ç³»ç»Ÿã€WHMCS è´¢åŠ¡ç³»ç»Ÿå¯¹æ¥å’Œé•œåƒæ¨¡æ¿å¸‚åœºã€‚è¿™ä½¿å¾— OpenLXD æˆä¸ºä¸€ä¸ªå®Œæ•´çš„ã€ç”Ÿäº§çº§çš„å®¹å™¨ç®¡ç†å’Œé”€å”®å¹³å°ã€‚

## âœ¨ æ–°å¢åŠŸèƒ½

### 1. å¤šç§Ÿæˆ·ç®¡ç†ç³»ç»Ÿ

**ç”¨æˆ·ç³»ç»Ÿï¼š**
- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- JWT Token è®¤è¯ï¼ˆWeb ç•Œé¢ï¼‰
- API Key è®¤è¯ï¼ˆWHMCS å¯¹æ¥ï¼‰
- ç”¨æˆ·è§’è‰²ç®¡ç†ï¼ˆadmin/userï¼‰
- ç”¨æˆ·çŠ¶æ€ç®¡ç†ï¼ˆactive/suspended/deletedï¼‰
- å¯†ç åŠ å¯†ï¼ˆbcryptï¼‰
- API å¯†é’¥è‡ªåŠ¨ç”Ÿæˆå’Œé‡æ–°ç”Ÿæˆ

**æƒé™æ§åˆ¶ï¼š**
- å®¹å™¨æ‰€æœ‰æƒç®¡ç†
- æ™®é€šç”¨æˆ·åªèƒ½ç®¡ç†è‡ªå·±çš„å®¹å™¨
- ç®¡ç†å‘˜å¯ä»¥ç®¡ç†æ‰€æœ‰å®¹å™¨å’Œç”¨æˆ·
- ä¸¥æ ¼çš„æƒé™éªŒè¯

**æ•°æ®æ¨¡å‹ï¼š**
- æ–°å¢ `users` è¡¨
- `containers` è¡¨æ·»åŠ  `user_id` å’Œ `created_by` å­—æ®µ

### 2. WHMCS å…¼å®¹ API

**7 ä¸ªæ ¸å¿ƒç«¯ç‚¹ï¼š**
- `POST /api/v1/whmcs/container/create` - åˆ›å»ºå®¹å™¨
- `POST /api/v1/whmcs/container/start` - å¯åŠ¨å®¹å™¨
- `POST /api/v1/whmcs/container/stop` - åœæ­¢å®¹å™¨
- `POST /api/v1/whmcs/container/restart` - é‡å¯å®¹å™¨
- `POST /api/v1/whmcs/container/delete` - åˆ é™¤å®¹å™¨
- `GET /api/v1/whmcs/container/info` - è·å–å®¹å™¨ä¿¡æ¯
- `POST /api/v1/whmcs/container/config` - æ›´æ–°å®¹å™¨é…ç½®

**ç‰¹æ€§ï¼š**
- API Key è®¤è¯ï¼ˆè¯·æ±‚å¤´ï¼š`X-API-Key`ï¼‰
- è‡ªåŠ¨ IP åœ°å€åˆ†é…
- å®¹å™¨æ‰€æœ‰æƒéªŒè¯
- æ ‡å‡†åŒ– JSON å“åº”æ ¼å¼
- è¯¦ç»†çš„é”™è¯¯æ¶ˆæ¯

**å…¼å®¹æ€§ï¼š**
- éµå¾ª lxdapi é¡¹ç›®çš„ API è§„èŒƒ
- å¯ç›´æ¥å¯¹æ¥ WHMCSã€HostBill ç­‰è´¢åŠ¡ç³»ç»Ÿ
- æ”¯æŒå®¹å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
- æ”¯æŒèµ„æºé…ç½®åŠ¨æ€è°ƒæ•´

### 3. é•œåƒæ¨¡æ¿å¸‚åœº

**é•œåƒç®¡ç†ï¼š**
- ä» https://images.linuxcontainers.org/ å¯¼å…¥é•œåƒ
- 22 ä¸ªé¢„å®šä¹‰å¸¸ç”¨é•œåƒ
- å¼‚æ­¥é•œåƒå¯¼å…¥
- é•œåƒçŠ¶æ€è·Ÿè¸ª
- æœ¬åœ°é•œåƒç®¡ç†

**æ”¯æŒçš„å‘è¡Œç‰ˆï¼š**
- Ubuntu: 24.04, 22.04, 20.04, 18.04
- Debian: 12, 11, 10
- CentOS: 9-Stream, 8-Stream, 7
- Alpine: 3.19, 3.18, 3.17, 3.16
- Rocky Linux: 9, 8
- Fedora: 40, 39, 38
- Arch Linux: current
- Oracle Linux: 9, 8

**API ç«¯ç‚¹ï¼š**
- `GET /api/v1/images/list` - è·å–æœ¬åœ°é•œåƒåˆ—è¡¨
- `GET /api/v1/images/remote` - è·å–è¿œç¨‹é•œåƒåˆ—è¡¨
- `POST /api/v1/images/import` - å¯¼å…¥é•œåƒï¼ˆç®¡ç†å‘˜ï¼‰
- `DELETE /api/v1/images/:alias` - åˆ é™¤é•œåƒï¼ˆç®¡ç†å‘˜ï¼‰
- `POST /api/v1/images/sync` - åŒæ­¥ LXD é•œåƒåˆ°æ•°æ®åº“ï¼ˆç®¡ç†å‘˜ï¼‰

**æ•°æ®æ¨¡å‹ï¼š**
- æ–°å¢ `images` è¡¨
- é•œåƒåˆ«åã€æŒ‡çº¹ã€å‘è¡Œç‰ˆã€ç‰ˆæœ¬ç­‰ä¿¡æ¯
- å¯¼å…¥çŠ¶æ€è·Ÿè¸ª

### 4. Web ç•Œé¢æ›´æ–°

**æ–°å¢é¡µé¢ï¼š**
- ç™»å½•/æ³¨å†Œé¡µé¢ï¼ˆå…¨æ–°è®¾è®¡ï¼‰
- ç”¨æˆ·ç®¡ç†é¡µé¢ï¼ˆç®¡ç†å‘˜ï¼‰
- é•œåƒå¸‚åœºé¡µé¢

**æ–°å¢åŠŸèƒ½ï¼š**
- ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
- API å¯†é’¥ç®¡ç†å’Œé‡æ–°ç”Ÿæˆ
- ç”¨æˆ·åˆ—è¡¨å’ŒçŠ¶æ€ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰
- ç”¨æˆ·è§’è‰²ç®¡ç†ï¼ˆç®¡ç†å‘˜ï¼‰
- æœ¬åœ°é•œåƒåˆ—è¡¨
- è¿œç¨‹é•œåƒæµè§ˆ
- æŒ‰å‘è¡Œç‰ˆè¿‡æ»¤é•œåƒ
- é•œåƒå¯¼å…¥ï¼ˆå¼‚æ­¥ï¼‰
- ä»é•œåƒåˆ›å»ºå®¹å™¨

**JavaScript æ¨¡å—ï¼š**
- `web/static/user.js` - ç”¨æˆ·ç®¡ç†æ¨¡å—
- `web/static/images.js` - é•œåƒå¸‚åœºæ¨¡å—

## ğŸ”§ æŠ€æœ¯æ”¹è¿›

### åç«¯

**æ–°å¢åŒ…ï¼š**
- `internal/auth` - è®¤è¯å’Œæˆæƒ
- `internal/api/user.go` - ç”¨æˆ·ç®¡ç† API
- `internal/api/whmcs.go` - WHMCS å…¼å®¹ API
- `internal/api/image.go` - é•œåƒç®¡ç† API
- `internal/lxd/api_wrapper.go` - LXD å®¢æˆ·ç«¯åŒ…è£…å™¨

**æ–°å¢ä¾èµ–ï¼š**
- `github.com/golang-jwt/jwt/v5` - JWT Token ç”Ÿæˆå’ŒéªŒè¯
- `golang.org/x/crypto/bcrypt` - å¯†ç åŠ å¯†

**æ•°æ®åº“ï¼š**
- æ–°å¢ 2 ä¸ªè¡¨ï¼ˆusers, imagesï¼‰
- ä¿®æ”¹ 1 ä¸ªè¡¨ï¼ˆcontainersï¼‰
- è‡ªåŠ¨è¿ç§»

### å‰ç«¯

**è®¾è®¡æ”¹è¿›ï¼š**
- ç°ä»£åŒ–ç™»å½•é¡µé¢ï¼ˆæ¸å˜èƒŒæ™¯ï¼‰
- æ ‡ç­¾åˆ‡æ¢ï¼ˆç™»å½•/æ³¨å†Œï¼‰
- å“åº”å¼è®¾è®¡
- é€šçŸ¥æç¤ºç³»ç»Ÿ

**ç”¨æˆ·ä½“éªŒï¼š**
- è¡¨å•éªŒè¯
- é”™è¯¯æç¤º
- åŠ è½½çŠ¶æ€
- ç©ºçŠ¶æ€æç¤º

## ğŸ“Š ç»Ÿè®¡æ•°æ®

### ä»£ç 

- **æ–°å¢ä»£ç ï¼š** +3,500 è¡Œ
- **æ€»ä»£ç é‡ï¼š** ~13,700 è¡Œ
- **æ–°å¢æ–‡ä»¶ï¼š** 11 ä¸ª
- **ä¿®æ”¹æ–‡ä»¶ï¼š** 3 ä¸ª

### API

- **åŸæœ‰ç«¯ç‚¹ï¼š** 40 ä¸ª
- **æ–°å¢ç«¯ç‚¹ï¼š** 23 ä¸ª
- **æ€»è®¡ç«¯ç‚¹ï¼š** 63 ä¸ª

### æ•°æ®åº“

- **åŸæœ‰è¡¨ï¼š** 11 ä¸ª
- **æ–°å¢è¡¨ï¼š** 2 ä¸ª
- **æ€»è®¡è¡¨ï¼š** 13 ä¸ª

### äºŒè¿›åˆ¶

- **åŸå¤§å°ï¼š** 16MB
- **æ–°å¤§å°ï¼š** 24MB
- **å¢åŠ ï¼š** +8MBï¼ˆJWT å’Œè®¤è¯åŠŸèƒ½ï¼‰

### åŠŸèƒ½å®Œæ•´åº¦

- **v3.4.0ï¼š** 95%
- **v3.5.0ï¼š** 98%
- **å¢åŠ ï¼š** +3%

## ğŸ”’ å®‰å…¨æ€§

### è®¤è¯å’Œæˆæƒ

- **å¯†ç åŠ å¯†ï¼š** bcryptï¼ˆé»˜è®¤ costï¼‰
- **JWT Tokenï¼š** HS256 ç®—æ³•ï¼Œ24 å°æ—¶æœ‰æ•ˆæœŸ
- **API Keyï¼š** 64 ä½éšæœºåå…­è¿›åˆ¶å­—ç¬¦ä¸²
- **æƒé™éªŒè¯ï¼š** ä¸¥æ ¼çš„ç”¨æˆ·æƒé™æ£€æŸ¥
- **å®¹å™¨éš”ç¦»ï¼š** ç”¨æˆ·åªèƒ½è®¿é—®è‡ªå·±çš„å®¹å™¨

### å®‰å…¨å»ºè®®

1. ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹ JWT å¯†é’¥
2. å¯ç”¨ HTTPS
3. å®šæœŸæ›´æ–°å¯†ç 
4. å®šæœŸå®¡è®¡ç”¨æˆ·æƒé™
5. ç›‘æ§ API è®¿é—®æ—¥å¿—

## ğŸ“ API å˜æ›´

### æ–°å¢ API

**ç”¨æˆ·ç®¡ç†ï¼ˆ8 ä¸ªï¼‰ï¼š**
- POST `/api/v1/users/register`
- POST `/api/v1/users/login`
- GET `/api/v1/users/profile`
- POST `/api/v1/users/regenerate-key`
- GET `/api/v1/users/list`
- POST `/api/v1/users/status`
- POST `/api/v1/users/role`
- GET `/api/v1/users/containers`

**WHMCS å¯¹æ¥ï¼ˆ7 ä¸ªï¼‰ï¼š**
- POST `/api/v1/whmcs/container/create`
- POST `/api/v1/whmcs/container/start`
- POST `/api/v1/whmcs/container/stop`
- POST `/api/v1/whmcs/container/restart`
- POST `/api/v1/whmcs/container/delete`
- GET `/api/v1/whmcs/container/info`
- POST `/api/v1/whmcs/container/config`

**é•œåƒç®¡ç†ï¼ˆ5 ä¸ªï¼‰ï¼š**
- GET `/api/v1/images/list`
- GET `/api/v1/images/remote`
- POST `/api/v1/images/import`
- DELETE `/api/v1/images/:alias`
- POST `/api/v1/images/sync`

### è®¤è¯æ–¹å¼

**JWT Tokenï¼ˆWeb ç•Œé¢ï¼‰ï¼š**
```
Authorization: Bearer <token>
```

**API Keyï¼ˆWHMCS å¯¹æ¥ï¼‰ï¼š**
```
X-API-Key: <api_key>
```

### å…¼å®¹æ€§

- âœ… å®Œå…¨å‘åå…¼å®¹
- âœ… ç°æœ‰ API ä¿æŒä¸å˜
- âœ… æ–° API ä½¿ç”¨ `/api/v1/` å‰ç¼€

## ğŸ› Bug ä¿®å¤

- ä¿®å¤äº† LXD é•œåƒå¯¼å…¥æ—¶çš„ç±»å‹é”™è¯¯
- ä¿®å¤äº†å®¹å™¨é…ç½®æ›´æ–°æ—¶çš„å‚æ•°é”™è¯¯
- æ”¹è¿›äº†é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

## ğŸ“š æ–‡æ¡£

### æ–°å¢æ–‡æ¡£

- `DESIGN_MULTITENANT_IMAGES.md` - ç³»ç»Ÿè®¾è®¡æ–‡æ¡£
- `UPDATE_V3.5.0.md` - è¯¦ç»†æ›´æ–°è¯´æ˜
- `INTEGRATION_GUIDE_V3.5.0.md` - é›†æˆæŒ‡å—
- `CHANGELOG_V3.5.0.md` - æœ¬æ›´æ–°æ—¥å¿—

### æ›´æ–°æ–‡æ¡£

- `README.md` - æ·»åŠ æ–°åŠŸèƒ½è¯´æ˜
- API æ–‡æ¡£ - æ·»åŠ æ–°ç«¯ç‚¹

## ğŸš€ å‡çº§æŒ‡å—

### ä» v3.4.0 å‡çº§

1. **å¤‡ä»½æ•°æ®åº“**
   ```bash
   cp /var/lib/openlxd/openlxd.db /var/lib/openlxd/openlxd.db.backup
   ```

2. **æ›´æ–°ä»£ç **
   ```bash
   cd /home/ubuntu/openlxd-final
   git pull origin master
   ```

3. **å®‰è£…æ–°ä¾èµ–**
   ```bash
   go get github.com/golang-jwt/jwt/v5
   go get golang.org/x/crypto/bcrypt
   ```

4. **ä¿®æ”¹ main.go**
   - å‚è€ƒ `INTEGRATION_GUIDE_V3.5.0.md`
   - æ·»åŠ æ–°çš„å¯¼å…¥
   - æ·»åŠ æ–°çš„è·¯ç”±
   - æ·»åŠ æ–°çš„ä¸­é—´ä»¶

5. **é‡æ–°ç¼–è¯‘**
   ```bash
   go build -o bin/openlxd-linux-amd64
   ```

6. **é‡å¯æœåŠ¡**
   ```bash
   systemctl restart openlxd
   ```

7. **åˆ›å»ºé¦–ä¸ªç®¡ç†å‘˜**
   ```bash
   # æ³¨å†Œç”¨æˆ·
   curl -X POST http://localhost:8080/api/v1/users/register \
     -H "Content-Type: application/json" \
     -d '{"username":"admin","email":"admin@example.com","password":"admin123456"}'
   
   # æ‰‹åŠ¨è®¾ç½®ä¸ºç®¡ç†å‘˜
   sqlite3 /var/lib/openlxd/openlxd.db "UPDATE users SET role = 'admin' WHERE id = 1;"
   ```

## âš ï¸ ç ´åæ€§å˜æ›´

æ— ç ´åæ€§å˜æ›´ï¼Œå®Œå…¨å‘åå…¼å®¹ã€‚

## ğŸ”® å·²çŸ¥é—®é¢˜

1. é•œåƒå¯¼å…¥è¿›åº¦æ— æ³•å®æ—¶æŸ¥çœ‹ï¼ˆè®¡åˆ’åœ¨ v3.6.0 æ·»åŠ  WebSocket æ”¯æŒï¼‰
2. é¦–ä¸ªç”¨æˆ·éœ€è¦æ‰‹åŠ¨è®¾ç½®ä¸ºç®¡ç†å‘˜
3. é•œåƒå¯¼å…¥å¯èƒ½éœ€è¦å‡ åˆ†é’Ÿæ—¶é—´

## ğŸ“… ä¸‹ä¸€æ­¥è®¡åˆ’

### v3.6.0ï¼ˆè®¡åˆ’ä¸­ï¼‰

- WebSocket å®æ—¶é€šçŸ¥
- é•œåƒå¯¼å…¥è¿›åº¦å®æ—¶è·Ÿè¸ª
- å¤šç§Ÿæˆ·é…é¢ç®¡ç†
- å®¹å™¨è¿ç§»åŠŸèƒ½å®Œå–„

### v4.0.0ï¼ˆé•¿æœŸè®¡åˆ’ï¼‰

- é›†ç¾¤ç®¡ç†
- è´Ÿè½½å‡è¡¡
- é«˜å¯ç”¨æ€§
- å®¹å™¨ç¼–æ’

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸º OpenLXD é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…å’Œç”¨æˆ·ã€‚

## ğŸ“ æ”¯æŒ

- GitHub: https://github.com/areyouokbro/openlxd
- Issues: https://github.com/areyouokbro/openlxd/issues
- Discussions: https://github.com/areyouokbro/openlxd/discussions

## ğŸ“„ è®¸å¯è¯

MIT License

---

**å®Œæ•´çš„æ›´æ–°è¯´æ˜è¯·æŸ¥çœ‹ï¼š**
- `UPDATE_V3.5.0.md` - è¯¦ç»†æŠ€æœ¯è¯´æ˜
- `INTEGRATION_GUIDE_V3.5.0.md` - é›†æˆå’Œæµ‹è¯•æŒ‡å—
- `DESIGN_MULTITENANT_IMAGES.md` - ç³»ç»Ÿè®¾è®¡æ–‡æ¡£
